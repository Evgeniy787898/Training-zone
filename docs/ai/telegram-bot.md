# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Telegram-–±–æ—Ç–∞ TZONA

> **–í–µ—Ä—Å–∏—è:** 1.0.0  
> **–î–∞—Ç–∞:** 2025-12-07

## –û–±–∑–æ—Ä

Telegram-–±–æ—Ç TZONA ‚Äî –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–π –∫–∞–Ω–∞–ª –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è —Å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ–º, —Ä–∞–±–æ—Ç–∞—é—â–∏–π –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ —Å WebApp.

**–í–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞:**
- –ü—Ä–æ—Å–º–æ—Ç—Ä –ø–ª–∞–Ω–∞ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–æ–∫ –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
- –ü–æ–ª—É—á–µ–Ω–∏–µ AI-—Å–æ–≤–µ—Ç–æ–≤
- –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞—Ö
- –ë—ã—Å—Ç—Ä—ã–π –¥–æ—Å—Ç—É–ø –∫ WebApp

---

## –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞ —á–µ—Ä–µ–∑ @BotFather

### –®–∞–≥ 1: –°–æ–∑–¥–∞–Ω–∏–µ –±–æ—Ç–∞

1. –û—Ç–∫—Ä–æ–π—Ç–µ Telegram –∏ –Ω–∞–π–¥–∏—Ç–µ [@BotFather](https://t.me/BotFather)
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ –∫–æ–º–∞–Ω–¥—É `/newbot`
3. –í–≤–µ–¥–∏—Ç–µ –∏–º—è –±–æ—Ç–∞: `TZONA Fitness` (–æ—Ç–æ–±—Ä–∞–∂–∞–µ–º–æ–µ –∏–º—è)
4. –í–≤–µ–¥–∏—Ç–µ username –±–æ—Ç–∞: `tzona_fitness_bot` (–¥–æ–ª–∂–µ–Ω –∑–∞–∫–∞–Ω—á–∏–≤–∞—Ç—å—Å—è –Ω–∞ `bot`)
5. –°–∫–æ–ø–∏—Ä—É–π—Ç–µ –ø–æ–ª—É—á–µ–Ω–Ω—ã–π **API —Ç–æ–∫–µ–Ω**

> [!CAUTION]
> –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –ø—É–±–ª–∏–∫—É–π—Ç–µ —Ç–æ–∫–µ–Ω –±–æ—Ç–∞ –≤ –ø—É–±–ª–∏—á–Ω—ã—Ö —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è—Ö –∏–ª–∏ –ª–æ–≥–∞—Ö!

### –®–∞–≥ 2: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–æ—Ç–∞

1. –í —á–∞—Ç–µ —Å @BotFather –æ—Ç–ø—Ä–∞–≤—å—Ç–µ `/mybots`
2. –í—ã–±–µ—Ä–∏—Ç–µ —Å–æ–∑–¥–∞–Ω–Ω–æ–≥–æ –±–æ—Ç–∞
3. –ù–∞–∂–º–∏—Ç–µ **Edit Bot** ‚Üí **Edit Description**:
   ```
   üèãÔ∏è TZONA ‚Äî —Ç–≤–æ–π –ø–µ—Ä—Å–æ–Ω–∞–ª—å–Ω—ã–π —Ñ–∏—Ç–Ω–µ—Å-–∞—Å—Å–∏—Å—Ç–µ–Ω—Ç —Å AI
   
   –û—Ç—Å–ª–µ–∂–∏–≤–∞–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏, –ø–æ–ª—É—á–∞–π —Å–æ–≤–µ—Ç—ã –∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∏—Ä—É–π!
   ```
4. **Edit About**:
   ```
   –§–∏—Ç–Ω–µ—Å-—Ç—Ä–µ–∫–µ—Ä —Å AI-—Å–æ–≤–µ—Ç–∞–º–∏. –û—Ç–∫—Ä–æ–π WebApp –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞.
   ```
5. **Edit Bot Pic** ‚Äî –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ª–æ–≥–æ—Ç–∏–ø TZONA

### –®–∞–≥ 3: –ù–∞—Å—Ç—Ä–æ–π–∫–∞ WebApp

1. –í @BotFather –≤—ã–±–µ—Ä–∏—Ç–µ –±–æ—Ç–∞ ‚Üí **Bot Settings** ‚Üí **Menu Button**
2. **Configure menu button**:
   - URL: `https://your-ngrok-url.ngrok-free.app` (–∏–ª–∏ production URL)
   - Button text: `üöÄ –û—Ç–∫—Ä—ã—Ç—å TZONA`

### –®–∞–≥ 4: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∫–æ–º–∞–Ω–¥

–í @BotFather ‚Üí **Edit Commands**:
```
start - –ù–∞—á–∞—Ç—å —Ä–∞–±–æ—Ç—É —Å –±–æ—Ç–æ–º
help - –ü–æ–º–æ—â—å –∏ —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥
today - –ü–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è
week - –ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é
progress - –ú–æ–π –ø—Ä–æ–≥—Ä–µ—Å—Å
advice - –ü–æ–ª—É—á–∏—Ç—å AI-—Å–æ–≤–µ—Ç
webapp - –û—Ç–∫—Ä—ã—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
settings - –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
```

---

## –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –≤ TZONA

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

–î–æ–±–∞–≤—å—Ç–µ –≤ `.env`:

```bash
# Telegram Bot
TELEGRAM_BOT_TOKEN="1234567890:ABCdefGHIjklMNOpqrsTUVwxyz"
TELEGRAM_WEBAPP_SECRET="your_webapp_secret"

# WebApp URL (ngrok –¥–ª—è dev, production URL –¥–ª—è prod)
WEBAPP_URL="https://your-url.ngrok-free.app"
```

### –ó–∞–ø—É—Å–∫ —Å –±–æ—Ç–æ–º

```bash
# –ë–æ—Ç –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —á–µ—Ä–µ–∑ start-with-ngrok.sh
./start-with-ngrok.sh

# –í –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –ø–æ—è–≤–∏—Ç—å—Å—è:
# bot | Telegram bot started: @tzona_fitness_bot
```

---

## –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –±–æ—Ç–∞

```
backend/src/bot/
‚îú‚îÄ‚îÄ index.ts           # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ –±–æ—Ç–∞
‚îú‚îÄ‚îÄ handlers/          # –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–æ–º–∞–Ω–¥
‚îÇ   ‚îú‚îÄ‚îÄ start.ts       # /start –∫–æ–º–∞–Ω–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ today.ts       # /today –∫–æ–º–∞–Ω–¥–∞
‚îÇ   ‚îî‚îÄ‚îÄ advice.ts      # AI-–∫–æ–º–∞–Ω–¥—ã
‚îú‚îÄ‚îÄ services/          # –°–µ—Ä–≤–∏—Å—ã –±–æ—Ç–∞
‚îÇ   ‚îî‚îÄ‚îÄ inactivityMonitor.ts  # –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è
‚îî‚îÄ‚îÄ middleware/        # Middleware
    ‚îî‚îÄ‚îÄ auth.ts        # –ü—Ä–∏–≤—è–∑–∫–∞ –∫ Profile
```

---

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | AI |
|---------|----------|----|
| `/start` | –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ + –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ | ‚ùå |
| `/help` | –°–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥ | ‚ùå |
| `/today` | –ü–ª–∞–Ω –Ω–∞ —Å–µ–≥–æ–¥–Ω—è | ‚ùå |
| `/week` | –ü–ª–∞–Ω –Ω–∞ –Ω–µ–¥–µ–ª—é | ‚ùå |
| `/progress` | –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ | ‚ùå |
| `/advice` | AI-—Å–æ–≤–µ—Ç –¥–Ω—è | ‚úÖ |
| `/ask <–≤–æ–ø—Ä–æ—Å>` | –í–æ–ø—Ä–æ—Å AI | ‚úÖ |
| `/webapp` | –°—Å—ã–ª–∫–∞ –Ω–∞ WebApp | ‚ùå |
| `/settings` | –ù–∞—Å—Ç—Ä–æ–π–∫–∏ | ‚ùå |

---

## Troubleshooting

### –ë–æ—Ç –Ω–µ –æ—Ç–≤–µ—á–∞–µ—Ç

**–ü—Ä–∏—á–∏–Ω–∞:** –¢–æ–∫–µ–Ω –Ω–µ–≤–µ—Ä–Ω—ã–π –∏–ª–∏ –ø—Ä–æ—Ü–µ—Å—Å –±–æ—Ç–∞ –Ω–µ –∑–∞–ø—É—â–µ–Ω.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Ç–æ–∫–µ–Ω
grep TELEGRAM_BOT_TOKEN .env

# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
# –í —Ç–µ—Ä–º–∏–Ω–∞–ª–µ –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ —Å [bot]
```

### WebApp –Ω–µ –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç—Å—è (–æ—à–∏–±–∫–∞ "Failed to load")

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π WEBAPP_URL –∏–ª–∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç.

**–†–µ—à–µ–Ω–∏–µ:**
1. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ ngrok –∑–∞–ø—É—â–µ–Ω
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ URL –≤ @BotFather ‚Üí Menu Button
3. URL –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å HTTPS

### –ö–æ–º–∞–Ω–¥—ã –Ω–µ –ø–æ—è–≤–ª—è—é—Ç—Å—è –≤ –º–µ–Ω—é

**–ü—Ä–∏—á–∏–Ω–∞:** –ö–æ–º–∞–Ω–¥—ã –Ω–µ –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω—ã.

**–†–µ—à–µ–Ω–∏–µ:**
1. @BotFather ‚Üí Edit Commands
2. –î–æ–±–∞–≤—å—Ç–µ –≤—Å–µ –∫–æ–º–∞–Ω–¥—ã (—Å–º. –≤—ã—à–µ)
3. –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ Telegram

### AI-–∫–æ–º–∞–Ω–¥—ã –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫—É

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω GEMINI_API_KEY.

**–†–µ—à–µ–Ω–∏–µ:**
```bash
# –ü—Ä–æ–≤–µ—Ä—å—Ç–µ .env
grep GEMINI .env
# –î–æ–ª–∂–Ω–æ –±—ã—Ç—å: GEMINI_API_KEY=AIza...

# –°–º. docs/ai/README.md –¥–ª—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
```

---

## –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è

–ë–æ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç –Ω–∞–ø–æ–º–∏–Ω–∞–Ω–∏—è:
- –ü—Ä–∏ –Ω–µ–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –±–æ–ª–µ–µ 2 –¥–Ω–µ–π
- –í –∑–∞–¥–∞–Ω–Ω–æ–µ –≤—Ä–µ–º—è (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è –≤ SettingsPage)

–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤ `backend/src/bot/services/inactivityMonitor.ts`:
```typescript
const INACTIVITY_THRESHOLD_DAYS = 2;
```

---

## –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

> [!IMPORTANT]
> - `TELEGRAM_BOT_TOKEN` —Ç–æ–ª—å–∫–æ –≤ `.env` (gitignored)
> - –í–∞–ª–∏–¥–∞—Ü–∏—è `initData` —á–µ—Ä–µ–∑ HMAC
> - –ü—Ä–∏–≤—è–∑–∫–∞ –∫ profileId —á–µ—Ä–µ–∑ telegramId

---

## –°–≤—è–∑–∞–Ω–Ω—ã–µ –¥–æ–∫—É–º–µ–Ω—Ç—ã

- [AI Configuration](./README.md)
- [Architecture Overview](../architecture/README.md)
- [Bot Service Code](../../backend/src/bot/)
