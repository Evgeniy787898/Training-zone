# Microservice Error Handling

Дата: 2025-11-20

## Изменения
1. `callMicroservice` теперь обогащает `AppError` подробностями: статус/headers ответа, тело ошибки и тип таймаута. Это позволяет фронтенду и мониторингам видеть источник сбоя и trace-id микросервиса.
2. Прокси `api/internal/*` возвращают стандартный формат ошибок через `respondWithAppError`, вместо произвольных JSON. Ошибки логируются с именем сервиса и трассировкой.
3. Документ фиксирует требования: все новые микросервисные вызовы должны использовать `services/microserviceGateway.ts`, а ответы прокси — `AppError` структуру.

## Использование
- При обращении к внешним FastAPI сервисам используйте `callMicroservice`. В случае ошибок payload попадёт в `error.details`.
- Если нужно проксировать HTTP напрямую, подключите хелпер `respondProxyError` из `routes/microservicesProxy.ts` или аналогичную логику.
